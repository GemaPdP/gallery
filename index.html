<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Galería Fotográfica - Gema Pinedo de Pedro</title>
    <meta name="description" content="Galería personal de fotografías con importación desde Google Drive">
    <meta name="author" content="Gema Pinedo de Pedro">
    
    <!-- React y dependencias -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>📸</text></svg>">
    
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
                'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
                sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            background-color: #f9fafb;
        }
        
        #root {
            width: 100vw;
            height: 100vh;
            min-height: 100vh;
        }
        
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-size: 18px;
            color: #6b7280;
            flex-direction: column;
            gap: 16px;
        }
        
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #e5e7eb;
            border-top: 4px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Estilos para mejorar la experiencia visual */
        .image-grid {
            display: grid;
            gap: 1rem;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        }
        
        @media (max-width: 640px) {
            .image-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                gap: 0.5rem;
            }
        }
        
        /* Animaciones suaves */
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Mejoras para el modal */
        .modal-backdrop {
            backdrop-filter: blur(4px);
        }
        
        /* Optimización para dispositivos móviles */
        @media (max-width: 768px) {
            .modal-content {
                margin: 1rem;
                max-width: calc(100vw - 2rem);
                max-height: calc(100vh - 2rem);
            }
        }
        
        /* Estilos para zoom */
        .modal-content.zoomed {
            overflow: auto;
            cursor: grab;
        }
        
        .modal-content.zoomed:active {
            cursor: grabbing;
        }
        
        /* Estilos para hacer las imágenes clickeables en HTML exportado */
        .image-card img {
            cursor: pointer;
        }
        
        .image-card a {
            display: block;
            width: 100%;
            height: 100%;
            position: relative;
        }
        
        .image-card a::after {
            content: '🔍';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 0.9em;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }
        
        .image-card:hover a::after {
            opacity: 1;
        }
    </style>
</head>
<body>
    <div id="root">
        <div class="loading">
            <div class="loading-spinner"></div>
            <div>Cargando galería fotográfica...</div>
        </div>
    </div>

    <script type="text/babel">
        const { useState, useRef, useCallback, useEffect } = React;
        
        // Iconos SVG como componentes React
        const Trash2 = ({ className = "w-6 h-6" }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="m3 6 3 0" />
                <path d="m6 6 0 14c0 1-1 2-2 2h8c1 0 2-1 2-2V6" />
                <path d="m8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2" />
                <line x1="10" x2="10" y1="11" y2="17" />
                <line x1="14" x2="14" y1="11" y2="17" />
            </svg>
        );

        const Upload = ({ className = "w-6 h-6" }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                <polyline points="7,10 12,15 17,10" />
                <line x1="12" x2="12" y1="15" y2="3" />
            </svg>
        );

        const Move = ({ className = "w-6 h-6" }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="5,9 2,12 5,15" />
                <polyline points="9,5 12,2 15,5" />
                <polyline points="15,19 12,22 9,19" />
                <polyline points="19,9 22,12 19,15" />
                <line x1="2" x2="22" y1="12" y2="12" />
                <line x1="12" x2="12" y1="2" y2="22" />
            </svg>
        );

        const X = ({ className = "w-6 h-6" }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="m18 6-12 12" />
                <path d="m6 6 12 12" />
            </svg>
        );

        const Github = ({ className = "w-6 h-6" }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4" />
                <path d="M9 18c-4.51 2-5-2-7-2" />
            </svg>
        );

        const User = ({ className = "w-6 h-6" }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                <circle cx="12" cy="7" r="4" />
            </svg>
        );

        const LogOut = ({ className = "w-6 h-6" }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
                <polyline points="16,17 21,12 16,7" />
                <line x1="21" x2="9" y1="12" y2="12" />
            </svg>
        );

        const ChevronLeft = ({ className = "w-6 h-6" }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="m15 18-6-6 6-6" />
            </svg>
        );

        const ChevronRight = ({ className = "w-6 h-6" }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="m9 18 6-6-6-6" />
            </svg>
        );

        const Download = ({ className = "w-6 h-6" }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                <polyline points="7,10 12,15 17,10" />
                <line x1="12" x2="12" y1="15" y2="3" />
            </svg>
        );

        const Edit = ({ className = "w-6 h-6" }) => (
            <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" />
                <path d="m18.5 2.5 3 3L12 15l-4 1 1-4 9.5-9.5z" />
            </svg>
        );

        const PhotoGallery = () => {
            const [images, setImages] = useState([]);
            const [draggedIndex, setDraggedIndex] = useState(null);
            const [isDragging, setIsDragging] = useState(false);
            const [selectedImage, setSelectedImage] = useState(null);
            const [user, setUser] = useState(null);
            const [showLogin, setShowLogin] = useState(false);
            const [loginForm, setLoginForm] = useState({ username: '', email: '' });
            const [isLoading, setIsLoading] = useState(true);
            const [isZoomed, setIsZoomed] = useState(false);
            const fileInputRef = useRef(null);

            // Cargar usuario y galería desde localStorage al iniciar
            useEffect(() => {
                const savedUser = localStorage.getItem('photoGalleryUser');
                if (savedUser) {
                    const userData = JSON.parse(savedUser);
                    setUser(userData);
                    
                    // Cargar galería específica del usuario
                    const userGallery = localStorage.getItem('gallery_' + userData.username);
                    if (userGallery) {
                        setImages(JSON.parse(userGallery));
                    }
                }
                
                // Simular carga inicial
                setTimeout(() => setIsLoading(false), 1000);
            }, []);

            // Verificar espacio disponible en localStorage
            const getStorageSize = () => {
                let total = 0;
                for (let key in localStorage) {
                    if (localStorage.hasOwnProperty(key)) {
                        total += localStorage[key].length + key.length;
                    }
                }
                return total;
            };

            const formatStorageSize = (bytes) => {
                const mb = bytes / (1024 * 1024);
                return mb.toFixed(2) + ' MB';
            };

            // Guardar galería cuando cambian las imágenes
            useEffect(() => {
                if (user && images.length >= 0) {
                    try {
                        const galleryData = JSON.stringify(images);
                        localStorage.setItem('gallery_' + user.username, galleryData);
                    } catch (error) {
                        if (error.name === 'QuotaExceededError') {
                            console.error('Error de almacenamiento: Cuota excedida');
                            alert('Almacenamiento lleno. Por favor, elimina algunas imágenes o exporta tu galería.');
                        }
                    }
                }
            }, [images, user]);

            // Funciones de autenticación
            const handleLogin = (e) => {
                e.preventDefault();
                if (loginForm.username.trim() && loginForm.email.trim()) {
                    const userData = {
                        username: loginForm.username.trim(),
                        email: loginForm.email.trim(),
                        avatar: 'https://github.com/' + loginForm.username + '.png',
                        loginTime: new Date().toISOString()
                    };
                    
                    setUser(userData);
                    localStorage.setItem('photoGalleryUser', JSON.stringify(userData));
                    
                    // Cargar galería del usuario
                    const userGallery = localStorage.getItem('gallery_' + userData.username);
                    if (userGallery) {
                        setImages(JSON.parse(userGallery));
                    } else {
                        setImages([]);
                    }
                    
                    setShowLogin(false);
                    setLoginForm({ username: '', email: '' });
                }
            };

            const handleLogout = () => {
                setUser(null);
                setImages([]);
                localStorage.removeItem('photoGalleryUser');
                setShowLogin(false);
            };

            const simulateGithubLogin = () => {
                const githubUser = {
                    username: 'Gema Pinedo de Pedro',
                    email: 'gema.pinedo@github.com',
                    avatar: 'https://github.com/github.png',
                    loginTime: new Date().toISOString(),
                    provider: 'github'
                };
                
                setUser(githubUser);
                localStorage.setItem('photoGalleryUser', JSON.stringify(githubUser));
                
                const userGallery = localStorage.getItem('gallery_' + githubUser.username);
                if (userGallery) {
                    setImages(JSON.parse(userGallery));
                } else {
                    setImages([]);
                }
                
                setShowLogin(false);
            };

            // Importar desde Google Drive
            const importFromGoogleDrive = () => {
                const modal = document.createElement('div');
                modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
                
                const content = document.createElement('div');
                content.className = 'bg-white rounded-lg shadow-xl p-6 w-full max-w-md';
                
                content.innerHTML = '<h3 class="text-lg font-semibold mb-4">Importar desde Google Drive</h3><p class="text-gray-600 mb-4">Pega el enlace público de tu imagen de Google Drive:</p><input type="url" id="driveUrl" placeholder="https://drive.google.com/file/d/..." class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 mb-4"><div class="text-xs text-gray-500 mb-4"><strong>📋 Instrucciones:</strong><br>1. Haz clic derecho en tu imagen en Google Drive<br>2. Selecciona "Obtener enlace"<br>3. Cambia los permisos a "Cualquier persona con el enlace"<br>4. Copia y pega el enlace aquí</div><div class="flex gap-3 justify-end"><button id="cancelBtn" class="px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">Cancelar</button><button id="importBtn" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">Importar</button></div>';
                
                modal.appendChild(content);
                document.body.appendChild(modal);
                
                const urlInput = content.querySelector('#driveUrl');
                const cancelBtn = content.querySelector('#cancelBtn');
                const importBtn = content.querySelector('#importBtn');
                
                cancelBtn.onclick = () => modal.remove();
                
                importBtn.onclick = () => {
                    const url = urlInput.value.trim();
                    if (url) {
                        const cleanUrl = url.replace(/[?&]usp=sharing/g, '').replace(/[?&]view/g, '');
                        const fileId = cleanUrl.match(/\/d\/([a-zA-Z0-9-_]+)/);
                        if (fileId) {
                            const directUrl = 'https://drive.google.com/uc?export=view&id=' + fileId[1];
                            const filename = 'Imagen-Drive-' + Date.now();
                            
                            const testImg = new Image();
                            testImg.onload = () => {
                                const newImage = {
                                    id: Date.now() + Math.random(),
                                    src: directUrl,
                                    name: filename,
                                    size: 0,
                                    isFromDrive: true,
                                    driveUrl: cleanUrl,
                                    driveFileId: fileId[1],
                                    uploadDate: new Date().toISOString()
                                };
                                
                                setImages(prev => [...prev, newImage]);
                                modal.remove();
                            };
                            
                            testImg.onerror = () => {
                                alert('No se pudo cargar la imagen desde Google Drive. Asegúrate de que el enlace es público.');
                            };
                            
                            testImg.src = directUrl;
                        } else {
                            alert('Por favor, introduce un enlace válido de Google Drive');
                        }
                    }
                };
                
                modal.onclick = (e) => {
                    if (e.target === modal) modal.remove();
                };
                
                urlInput.focus();
            };

            // Exportar galería como JSON
            const exportGallery = () => {
                const galleryData = {
                    metadata: {
                        galleryName: 'Galería de Gema Pinedo de Pedro',
                        owner: user.username,
                        ownerEmail: user.email,
                        exportDate: new Date().toISOString(),
                        totalImages: images.length,
                        driveImages: images.filter(img => img.isFromDrive).length,
                        version: "2.0"
                    },
                    images: images
                };
                
                const dataStr = JSON.stringify(galleryData, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                
                const link = document.createElement('a');
                link.href = URL.createObjectURL(dataBlob);
                link.download = 'galeria-' + user.username + '-' + new Date().toISOString().split('T')[0] + '.json';
                link.click();
            };

            // Compartir galería como HTML (simplificado para evitar errores de template literal)
            const shareAsHTML = async () => {
                if (images.length === 0) {
                    alert('No hay imágenes para compartir');
                    return;
                }

                try {
                    // Generar HTML simplificado sin template literals complejos
                    const imageCardsHTML = images.map((img, index) => {
                        return '<div class="image-card"><img src="' + img.src + '" alt="' + img.name + '" loading="lazy"><div class="image-info"><h3>' + img.name + '</h3><p>Tamaño: ' + (img.size ? Math.round(img.size / 1024) + ' KB' : 'Desconocido') + '</p></div></div>';
                    }).join('');

                    const htmlContent = '<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Galería de Gema Pinedo de Pedro</title><style>body{font-family:Arial,sans-serif;background:#f5f5f5;padding:20px}.container{max-width:1200px;margin:0 auto;background:white;border-radius:10px;padding:30px}.gallery{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px}.image-card{background:white;border-radius:10px;overflow:hidden;box-shadow:0 5px 15px rgba(0,0,0,0.1)}.image-card img{width:100%;height:200px;object-fit:cover}.image-info{padding:15px}</style></head><body><div class="container"><h1>Galería de Gema Pinedo de Pedro</h1><div class="gallery">' + imageCardsHTML + '</div></div></body></html>';

                    const blob = new Blob([htmlContent], { type: 'text/html' });
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = 'galeria-gema-pinedo-' + new Date().toISOString().split('T')[0] + '.html';
                    link.click();
                    URL.revokeObjectURL(url);

                } catch (error) {
                    console.error('Error generando HTML:', error);
                    alert('Error al generar el HTML compartible');
                }
            };

            // Manejar archivos arrastrados
            const handleDrop = useCallback((e) => {
                e.preventDefault();
                setIsDragging(false);
                
                const files = Array.from(e.dataTransfer.files);
                const imageFiles = files.filter(file => file.type.startsWith('image/'));
                
                imageFiles.forEach(file => {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        const newImage = {
                            id: Date.now() + Math.random(),
                            src: event.target.result,
                            name: file.name,
                            size: file.size,
                            isFromDrive: false,
                            uploadDate: new Date().toISOString()
                        };
                        setImages(prev => [...prev, newImage]);
                    };
                    reader.readAsDataURL(file);
                });
            }, []);

            const handleDragOver = (e) => {
                e.preventDefault();
                setIsDragging(true);
            };

            const handleDragLeave = (e) => {
                e.preventDefault();
                setIsDragging(false);
            };

            // Manejar selección de archivos
            const handleFileSelect = (e) => {
                const files = Array.from(e.target.files);
                
                files.forEach(file => {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        const newImage = {
                            id: Date.now() + Math.random(),
                            src: event.target.result,
                            name: file.name,
                            size: file.size,
                            isFromDrive: false,
                            uploadDate: new Date().toISOString()
                        };
                        setImages(prev => [...prev, newImage]);
                    };
                    reader.readAsDataURL(file);
                });
                
                e.target.value = '';
            };

            // Eliminar imagen
            const removeImage = (id) => {
                setImages(prev => prev.filter(img => img.id !== id));
                if (selectedImage && selectedImage.id === id) {
                    setSelectedImage(null);
                }
            };

            // Formatear tamaño de archivo
            const formatFileSize = (bytes) => {
                if (bytes === 0) return 'Tamaño desconocido';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            };

            // Pantalla de carga
            if (isLoading) {
                return (
                    <div className="loading">
                        <div className="loading-spinner"></div>
                        <div>Cargando galería fotográfica...</div>
                    </div>
                );
            }

            // Pantalla de login
            if (!user) {
                return (
                    <div className="w-full h-full bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-6">
                        <div className="bg-white rounded-lg shadow-xl p-8 w-full max-w-md fade-in">
                            <div className="text-center mb-8">
                                <div className="text-4xl mb-4">📸</div>
                                <h1 className="text-2xl font-bold text-gray-800 mb-2">
                                    Galería Fotográfica
                                </h1>
                                <p className="text-gray-600">
                                    Inicia sesión para acceder a tu galería personal
                                </p>
                            </div>

                            {!showLogin ? (
                                <div className="space-y-4">
                                    <button
                                        onClick={simulateGithubLogin}
                                        className="w-full flex items-center justify-center gap-3 bg-gray-800 text-white px-6 py-3 rounded-lg hover:bg-gray-900 transition-colors"
                                    >
                                        <Github className="h-5 w-5" />
                                        Continuar con GitHub (Demo)
                                    </button>
                                    
                                    <div className="relative">
                                        <div className="absolute inset-0 flex items-center">
                                            <div className="w-full border-t border-gray-300" />
                                        </div>
                                        <div className="relative flex justify-center text-sm">
                                            <span className="px-2 bg-white text-gray-500">o</span>
                                        </div>
                                    </div>

                                    <button
                                        onClick={() => setShowLogin(true)}
                                        className="w-full flex items-center justify-center gap-3 border-2 border-gray-300 text-gray-700 px-6 py-3 rounded-lg hover:border-gray-400 transition-colors"
                                    >
                                        <User className="h-5 w-5" />
                                        Crear perfil personalizado
                                    </button>
                                </div>
                            ) : (
                                <form onSubmit={handleLogin} className="space-y-4">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">
                                            Nombre de usuario
                                        </label>
                                        <input
                                            type="text"
                                            value={loginForm.username}
                                            onChange={(e) => setLoginForm(prev => ({ ...prev, username: e.target.value }))}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                                            placeholder="tu-usuario"
                                            required
                                        />
                                    </div>
                                    
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">
                                            Email
                                        </label>
                                        <input
                                            type="email"
                                            value={loginForm.email}
                                            onChange={(e) => setLoginForm(prev => ({ ...prev, email: e.target.value }))}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                                            placeholder="tu@email.com"
                                            required
                                        />
                                    </div>

                                    <div className="flex gap-3">
                                        <button
                                            type="button"
                                            onClick={() => setShowLogin(false)}
                                            className="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"
                                        >
                                            Cancelar
                                        </button>
                                        <button
                                            type="submit"
                                            className="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
                                        >
                                            Crear Perfil
                                        </button>
                                    </div>
                                </form>
                            )}
                        </div>
                    </div>
                );
            }

            return (
                <div className="w-full min-h-screen bg-gray-50 p-4 sm:p-6">
                    <div className="max-w-7xl mx-auto">
                        {/* Header con información del usuario */}
                        <div className="flex flex-col sm:flex-row sm:items-center justify-between mb-8 gap-4">
                            <div>
                                <h1 className="text-2xl sm:text-3xl font-bold text-gray-800">
                                    Galería de {user.username}
                                </h1>
                                <p className="text-gray-600 mt-1">
                                    Galería de joyas
                                </p>
                            </div>
                            
                            <div className="flex items-center gap-4">
                                <div className="flex items-center gap-3">
                                    <img 
                                        src={user.avatar} 
                                        alt={user.username}
                                        className="w-10 h-10 rounded-full border-2 border-gray-200"
                                        onError={(e) => {
                                            e.target.src = 'https://ui-avatars.com/api/?name=' + encodeURIComponent(user.username) + '&background=6366f1&color=fff';
                                        }}
                                    />
                                    <div className="text-right">
                                        <p className="font-medium text-gray-800 text-sm">{user.username}</p>
                                        <p className="text-xs text-gray-500">{user.email}</p>
                                    </div>
                                </div>
                                
                                <button
                                    onClick={handleLogout}
                                    className="flex items-center gap-2 px-3 py-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors"
                                    title="Cerrar sesión"
                                >
                                    <LogOut className="h-4 w-4" />
                                </button>
                            </div>
                        </div>

                        {/* Zona de Drop */}
                        <div
                            className={'border-2 border-dashed rounded-lg p-6 sm:p-8 mb-8 text-center transition-all duration-300 ' + (isDragging ? 'border-blue-500 bg-blue-50' : 'border-gray-300 hover:border-gray-400')}
                            onDrop={handleDrop}
                            onDragOver={handleDragOver}
                            onDragLeave={handleDragLeave}
                        >
                            <Upload className="mx-auto h-12 w-12 text-gray-400 mb-4" />
                            <p className="text-lg text-gray-600 mb-2">
                                Arrastra y suelta tus imágenes aquí
                            </p>
                            <p className="text-sm text-gray-500 mb-4">
                                o haz clic para seleccionar archivos
                            </p>
                            <div className="flex flex-col sm:flex-row gap-3 justify-center items-center">
                                <button
                                    onClick={() => fileInputRef.current?.click()}
                                    className="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
                                >
                                    Seleccionar Archivos
                                </button>
                                <button
                                    onClick={importFromGoogleDrive}
                                    className="px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"
                                >
                                    Importar desde Drive
                                </button>
                                {images.length > 0 && (
                                    <>
                                        <button
                                            onClick={exportGallery}
                                            className="px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2"
                                            title="Exportar galería como JSON"
                                        >
                                            <Download className="h-4 w-4" />
                                            Exportar JSON
                                        </button>
                                        <button
                                            onClick={shareAsHTML}
                                            className="px-6 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors flex items-center gap-2"
                                            title="Compartir galería como HTML"
                                        >
                                            Compartir HTML
                                        </button>
                                    </>
                                )}
                            </div>
                            <input
                                ref={fileInputRef}
                                type="file"
                                multiple
                                accept="image/*"
                                onChange={handleFileSelect}
                                className="hidden"
                            />
                        </div>

                        {/* Contador de imágenes */}
                        {images.length > 0 && (
                            <div className="mb-6 text-center">
                                <p className="text-gray-600 mb-2">
                                    {images.length} imagen{images.length !== 1 ? 'es' : ''} en la galería
                                </p>
                                <div className="flex justify-center gap-6 text-sm text-gray-500">
                                    <span>📁 Drive: {images.filter(img => img.isFromDrive).length}</span>
                                    <span>💻 Local: {images.filter(img => !img.isFromDrive).length}</span>
                                    <span>💾 Almacenamiento: {formatStorageSize(getStorageSize())}</span>
                                </div>
                            </div>
                        )}

                        {/* Galería de imágenes */}
                        <div className="image-grid">
                            {images.map((image, index) => (
                                <div
                                    key={image.id}
                                    className="relative group bg-white rounded-lg shadow-md overflow-hidden cursor-pointer transform hover:scale-105 transition-transform duration-200 fade-in"
                                >
                                    <div className="aspect-square overflow-hidden">
                                        <img
                                            src={image.src}
                                            alt={image.name}
                                            className="w-full h-full object-cover"
                                            onClick={(e) => {
                                                e.preventDefault();
                                                // Crear un enlace temporal para descargar la imagen
                                                const link = document.createElement('a');
                                                link.href = image.src;
                                                link.download = image.name || 'imagen-' + Date.now();
                                                link.target = '_blank';
                                                link.rel = 'noopener noreferrer';
                                                
                                                // Simular click para abrir en nueva pestaña con descarga
                                                document.body.appendChild(link);
                                                link.click();
                                                document.body.removeChild(link);
                                            }}
                                            loading="lazy"
                                            onError={(e) => {
                                                e.target.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik0xMDAgNTBMMTUwIDEwMEgxMDBIMTAwVjE1MEg1MFYxMDBINTBMMTAwIDUwWiIgZmlsbD0iIzlDQTNBRiIvPgo8dGV4dCB4PSIxMDAiIHk9IjE3MCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjEyIiBmaWxsPSIjNkI3Mjg0IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5JbWFnZW4gbm8gZGlzcG9uaWJsZTwvdGV4dD4KPHN2Zz4=';
                                            }}
                                        />
                                    </div>
                                    
                                    {/* Overlay con información */}
                                    <div className="absolute inset-0 bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex items-center justify-center">
                                        <div className="text-white text-center p-2">
                                            <p className="text-sm font-medium truncate">{image.name}</p>
                                            <p className="text-xs">{formatFileSize(image.size)}</p>
                                            {image.isFromDrive && <p className="text-xs text-green-300">📁 Drive</p>}
                                        </div>
                                    </div>

                                    {/* Botón eliminar */}
                                    <div className="absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200">
                                        <button
                                            onClick={(e) => {
                                                e.stopPropagation();
                                                removeImage(image.id);
                                            }}
                                            className="p-1 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors"
                                            title="Eliminar imagen"
                                        >
                                            <Trash2 className="h-4 w-4" />
                                        </button>
                                    </div>
                                </div>
                            ))}
                        </div>

                        {/* Mensaje cuando no hay imágenes */}
                        {images.length === 0 && (
                            <div className="text-center py-12">
                                <div className="text-6xl mb-4">📸</div>
                                <p className="text-gray-500 text-lg mb-2">
                                    No hay imágenes en la galería
                                </p>
                                <p className="text-gray-400 text-sm">
                                    Arrastra algunas imágenes para comenzar
                                </p>
                            </div>
                        )}
                    </div>

                    {/* Modal de imagen completa */}
                    {selectedImage && (
                        <div className="fixed inset-0 bg-black bg-opacity-90 modal-backdrop flex items-center justify-center z-50 p-4">
                            <div className="relative modal-content max-w-4xl max-h-full">
                                {/* Botón cerrar */}
                                <div className="absolute top-4 right-4 z-10">
                                    <button
                                        onClick={() => setSelectedImage(null)}
                                        className="p-2 bg-white bg-opacity-20 text-white rounded-full hover:bg-opacity-30 transition-all"
                                        title="Cerrar"
                                    >
                                        <X className="h-6 w-6" />
                                    </button>
                                </div>

                                {/* Imagen principal */}
                                <img
                                    src={selectedImage.src}
                                    alt={selectedImage.name}
                                    className="max-w-full max-h-full object-contain rounded-lg"
                                />

                                {/* Información de la imagen */}
                                <div className="absolute bottom-4 left-4 right-4 text-white bg-black bg-opacity-50 rounded-lg p-4">
                                    <p className="font-medium">{selectedImage.name}</p>
                                    <p className="text-sm opacity-75">{formatFileSize(selectedImage.size)}</p>
                                    {selectedImage.isFromDrive && (
                                        <p className="text-xs text-green-300 mt-1">📁 Desde Google Drive</p>
                                    )}
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // Renderizar la aplicación
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(PhotoGallery));
    </script>
</body>
</html>
